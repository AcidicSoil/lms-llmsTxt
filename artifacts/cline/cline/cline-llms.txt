<!-- llmstxt:source=dspy -->
# Cline — AI Agent for VS Code

## Project Purpose
Cline empowers developers by enabling AI agents to autonomously perform complex software development tasks within the VS Code environment. It combines Claude Sonnet’s agentic capabilities with a human-in-the-loop interface, allowing users to safely approve file changes and terminal commands while leveraging AI for code generation, debugging, testing, and tool extension. The project supports multiple LLM providers, offers rich UI interactions, and includes enterprise-grade features like SSO, observability, and private networking.

## Key Concepts

### Agentic AI
AI agents that autonomously execute development tasks — generating code, debugging, testing — with human approval gates.

**Implementation**: Core `ClineAgent` orchestrates tasks via configurable LLM providers (OpenAI, Anthropic, AWS Bedrock).

**Directory**: `src/core/agent/index.ts`

**Entry Point**: `dist/extension.js`

### Model Context Protocol (MCP)
A standardized communication protocol between the agent and UI/tool hooks to manage context, state, and task lifecycle.

**Implementation**: Protobuf-based messages in `proto/` directory. Generated code in `src/proto/`.

**Directory**: `proto/`, `src/proto/`

**Entry Point**: `src/core/controller/index.ts` (via `MCPClient`)

### Human-in-the-loop workflow
Tasks are executed by AI agents, with user approval required for file changes or terminal commands.

**Implementation**: UI hooks (`webview-ui/src/hooks.ts`) and task lifecycle events (`src/core/hooks/`).

**Directory**: `webview-ui/`, `src/core/hooks/`

**Entry Point**: `webview-ui/src/main.tsx` (UI), `src/core/controller/index.ts` (agent logic)

### Checkpointing and rollback
Supports saving state snapshots before critical operations to enable undo or revert.

**Implementation**: File snapshotting via `WorkspaceSnapshotter`, stored in local storage or remote backend.

**Directory**: `src/storage/`, `src/core/snapshot/`

**Entry Point**: `src/core/controller/index.ts` (checkpoint hooks)

### Custom tool integration
Users can extend Cline with custom tools via hooks and CLI plugins.

**Implementation**: Tool registration via `ToolRegistry`, exposed in `src/core/tools/`.

**Directory**: `src/core/tools/`, `scripts/`

**Entry Point**: `cli/dist/cli.mjs` (tool CLI)

### CLI and editor interoperability
Command-line interface for task control, with seamless integration into VS Code.

**Implementation**: `cli/` directory, uses `vscode` API for workspace access.

**Directory**: `cli/`, `scripts/`

**Entry Point**: `cli/dist/cli.mjs`

### Browser automation
Supports automated browser tasks (e.g., testing, UI interaction) via Puppeteer or Playwright.

**Implementation**: `webview-ui/` uses webviews with Playwright integrations.

**Directory**: `webview-ui/`, `scripts/`

**Entry Point**: `webview-ui/src/main.tsx` (browser automation hooks)

### Task management and context window control
Manages task queues, context windows, and resource limits for AI agents.

**Implementation**: `TaskManager` in `src/core/task/`, configurable via CLI or config files.

**Directory**: `src/core/task/`, `config/`

**Entry Point**: `src/core/controller/index.ts`

### VS Code extension architecture
Built as a standard VS Code extension with lifecycle hooks, commands, and webview UIs.

**Implementation**: Uses `vscode` API extensively.

**Directory**: `src/`, `dist/`

**Entry Point**: `dist/extension.js`

### Multi-root workspace support
Manages tasks across multiple root folders in a single workspace.

**Implementation**: `WorkspaceManager` handles multi-root contexts.

**Directory**: `src/core/workspace/`

**Entry Point**: `src/core/controller/index.ts`

### Auto-approve and auto-fix features
Automatically approves changes or fixes issues without user intervention (configurable).

**Implementation**: Configurable in `config/`, enabled via CLI flags.

**Directory**: `config/`, `cli/`

**Entry Point**: `cli/dist/cli.mjs`

## Architecture Overview

Cline is built as a VS Code extension with a layered architecture:

- **Core Agent Layer**: Orchestrates AI tasks via configurable LLM providers.
- **Hook System**: Manages task lifecycle events (pre/post tool use, approval).
- **Context Management**: Uses file and workspace snapshots for checkpointing.
- **UI Layer**: Renders chat interface with diff views, tool buttons, and checkpoint controls.
- **Extensibility Layer**: Hooks and protocols support custom tools and enterprise features.
- **Storage & Config Layer**: Manages settings, secrets, remote configurations.

Enterprise features like SSO, audit trails, and private networking are implemented via dedicated services integrated into the core architecture.

## Important Directories

- `cli/` — CLI tools and command handlers
- `webview-ui/` — Browser-based UI components and hooks
- `src/` — Main TypeScript source code (core logic, agents, tasks)
- `tests/` — Unit and integration tests (Vitest, Playwright)
- `docs/` — Project documentation, guides, and API references
- `evals/` — Evaluation scripts for performance and accuracy testing
- `.github/workflows/` — CI/CD pipelines (GitHub Actions)
- `scripts/` — Dev scripts (`npm run dev`, `compile`, etc.)
- `proto/` — Protobuf definitions for agent-to-ui communication
- `assets/` — Static assets, icons, and config templates

## Entry Points

- `cli/dist/cli.mjs` — CLI entry point (command-line interface)
- `dist/extension.js` — VS Code extension main module
- `src/core/controller/index.ts` — Core agent controller and task orchestrator
- `webview-ui/src/main.tsx` — Webview UI root component

## Development Info

The project is a TypeScript-based VS Code extension with CLI companion, using Protobuf for inter-process communication. Key dev workflows:

- `npm run dev` — Live development mode (file watching)
- `npm run compile` — Build extension
- `npm run test` — Run unit and integration tests
- `npm run e2e` — End-to-end testing with Playwright
- `npm run package` — Prepare VS Code extension package for installation
- `npm run protos` — Generate Protobuf code from `.proto` files

Dependencies:
- AI SDKs (Anthropic, OpenAI, AWS Bedrock)
- Telemetry libraries (OpenTelemetry)
- Testing tools (Vitest, Playwright)
- Linter & formatter (ESLint, Prettier)

CI/CD: GitHub Actions with `changeset` for versioning. Documentation is generated from `docs/` and sample use cases in `samples/`.

## Usage Examples

```bash
# Initialize Cline in VS Code with Claude Sonnet (or other LLM provider)
cline init --llm claude-sonnet

# Start an agentic task to generate and test a function
cline task generate --file src/utils.ts --tool test --approve-mode auto

# Approve or reject changes via the webview UI (open in browser)
cline ui --workspace ./my-project

# Run a task with custom tool integration
cline task debug --tool my-custom-tool --file src/server.js

# Manage multi-root workspace tasks
cline task list --workspace ./multi-root

# Auto-approve and auto-fix with checkpointing enabled
cline config set auto-approve true
cline config set checkpointing true
```
